
{% macro pageBody(pageBodyMatrix) %}
    {% import _self as macros %}

    {# loop through all of our blocks in the matrix #}
    {% for block in pageBodyMatrix.all() %}

        {% if block.type == "blockRichText" %}
            <div class="block-body">
                {{ block.body }}
            </div>

        {% elseif block.type == "blockSlider" %}

        {% elseif block.type == "blockImage" %}
            {% if block.caption != "" %}
            {% set imageCaption = block.caption %}
            {% elseif block.image.one().caption != "" %}
            {% set imageCaption = block.image.one().caption %}
            {% endif %}

            <div class="block-image">
                <a href="{{block.image.one().getUrl("pageBodyImageBlockBig")}}" target="_blank" data-lity data-caption="{{imageCaption|escape}}">
                    <picture>
                        <img src="{{block.image.one().getUrl("pageBodyImageBlockThumbnail")}}" alt="{{block.image.one().imageAlt}}" />
                    </picture>
                </a>

                <div class="image-caption">
                    {{ imageCaption }}
                </div>

            </div>
        {% elseif block.type == "blockPageList" %}

            {% if block.displayAs == "list" %}
                <div class="list-group">
                    {% for page in block.pages.all() %}
                        <a href="{{page.url}}" class="list-group-item list-group-item-action flex-column align-items-start">
                            <h5>{{ page.title }}</h5>
                            
                            {% if page.summary != "" %}
                                <p>{{ page.summary }}</p>
                            {% endif %}
                        </a>
                    {% endfor %}
                </div>
            {% elseif block.displayAs == "tabs" %}
                <div class="page-list-tabs">
                    <nav class="nav nav-tabs" role="tablist">
                        {% for page in block.pages.all() %}
                        <a class="nav-item nav-link {% if loop.first %}active{% endif %}" id="nav-{{ page.slug }}-tab" data-toggle="tab" href="#nav-{{ page.slug }}" role="tab" aria-controls="nav-{{ page.slug }}" aria-selected="false">{{ page.title }}</a>
                        {% endfor %}
                    </nav>
                    <div class="tab-content">
                        {% for page in block.pages.all() %}
                        <div class="tab-pane fade {% if loop.first %}show active{% endif %}" id="nav-{{ page.slug }}" role="tabpanel" aria-labelledby="nav-{{ page.slug }}-tab">
                            {{ macros.pageBody(page.body) }}
                        </div>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}

        {% endif %}

    {% endfor %}

{% endmacro %}

{% macro bootstrapCard(cardBlock) %}

    {% if cardBlock.type == 'blockCard' %}
    <div class="card">
        <div class="card-body">
            {% if cardBlock.cardTitleIcon != '' or cardBlock.cardTitle != '' %}
            <h4>
                {% if cardBlock.cardTitleIcon != "" %}<i class="fa {{cardBlock.cardTitleIcon}}" aria-hidden="true"></i>{% endif %}
                {{cardBlock.cardTitle}}
            </h4>
            {% endif %}

            {{cardBlock.cardBody}}

            {% if cardBlock.cardLinkPage.one() %}
            <a href="{{cardBlock.cardLinkPage.one().url}}" class="card-link">{% if cardBlock.cardLinkLabel != "" %}{{cardBlock.cardLinkLabel}}{% else %}{{cardBlock.cardLinkPage.one().title}}{% endif %}</a>
            {% endif %}
        </div>
    </div>
    {% else %}
    <p class="error">Not a <em>blockCard</em></p>
    {% endif %}

{% endmacro %}

{# showEntryFields(entry) #}
{% macro showEntryFields(entry) %}

    {% for fieldLayoutField in entry.getFieldLayout().getFields() %}

        {# get the field Model from the fieldId #}
        {% set field = craft.app.fields.getFieldById(fieldLayoutField.id) %}

        {# print the field handle and the field content  #}
        {{ field.handle }} :  entry.getContent()[field.handle] }}

    {% endfor %}

{% endmacro %}

{% macro displayFooterLinksList(footerLinksList) %}

    {% if footerLinksList|length %}
    <ul class="links-list">
        {% for blockLink in footerLinksList %}
            {% if blockLink.type == "blockPageLink" %}
            <li>
                <a href="{{blockLink.page.one().url}}">{{blockLink.page.one().title}}</a>
            </li>
            {% elseif blockLink.type == "blockCustomLink" %}
            <li>
                <a href="{{blockLink.linkURL}}">{{blockLink.label}}</a>
            </li>
            {% endif %}
        {% endfor %}
    </ul>
    {% endif %}

{% endmacro %}